
\chapter{A Mapping from Role-Based Models to Context Description Logics}
\label{cha:mapping}

In the last chapter we introduced a family of description logics which are capable of expressing
contextual knowledge. 

 

How to use cDLs in practice?

Semantics, even when durchdacht und präzise, hard to comprehend.

Motivation for looking into cDLs were role-based systems.

automatic mapping from such a system desirable.

Formal representation of role-based system necessary.

Chosen the family of CROMs introduced by Kühn.

Also say what limitations occur, what cannot be represented in cDL

\todo[inline]{paragraph about related work -> formalizing UML diagrams}

\section{A Formal Role-Based Modeling Language}
\label{sec:sigma-crom}


In this section we will present a syntactical variant of the \emph{Compartment Role Object Model}
defined in \textbf{[Ku-SLE15]}\todo{citation}. This variant is simply introduced for easier
explanation of the mapping to description logics.

\subsection{Type and Instance Level}
\label{sec:type-instance-level}

We omit the graphical notation and 

\todo[inline]{some more information}



\begin{definition}[Compartment Role Object Model]\label{def:scrom}
  Let \NT, \RT, \CT and \RST be finite and mutually disjoint sets of Natural Types, Role
  Types, Compartment Types, and Relationship Types, respectively.  The tuple
  $\Sigma = (\NT, \RT, \CT,\RST)$ is a \todo{or better alphabet?}\emph{vocabulary}.
  A \emph{Compartment Role Object Model \Mmc over $\Sigma$ ($\Sigma$-CROM)} is a tuple \MM where
  \begin{enumerate}
  \item $\fills\subseteq(\NT\cup\CT)\times\RT$ is a right-total binary relation,
  \item $\parts:\CT\to\Pmf$ is a bijection where \Pmf is an arbitrary but fixed partition of
    \RT, and
  \item $\rel:\RST\to\Smc$ is a bijection where $\Smc\subseteq\bigcup_{P\in\Pmf}P\times P$ is an
    irreflexive binary relation. \qedhere
  \end{enumerate}
\end{definition}

In the rest of this thesis, we use the following phrases:
\begin{itemize}
\item \emph{$T$ fills \rt} if $(T,\rt)\in\fills$,
\item \emph{\rt participates in \ct} if $\rt\in\parts(\ct)$,
\item \emph{\rst participates in \ct} if $\rel(\rst) = (\rt[1],\rt[2])$ with $\{\rt[1], \rt[2]\}\subseteq\parts(\ct)$,
\item \emph{\rt[1] and \rt[2] are related via \rst} if $(\rt[1],\rt[2]) = \rel(\rst)$, and
\item \emph{\rt[1] is the domain of \rst ($\dom(\rst)$) and \rt[2] is the range of \rst
    ($\ran(\rst)$)} if $(\rt[1],\rt[2])\in\rel(\rst)$.
\end{itemize}



Since \fills is a right-total relation, for each role type there exists a natural type or
compartment type that fills it.  As each element of \Pmf is a non-empty subset of \RT, the image
of \parts does not contain the empty set.  Since \Pmf is a partition each role type participates in
only one compartment type.  Due to the irreflexivity of \Smc there exists no $\rst \in \RST$ and
$\rt \in \RT$ such that $\rel(\rst) = (\rt,\rt)$. Furthermore, since \Smc is a subset of
$\bigcup_{P\in\Pmf}P\times P$, the pair of role types in the image of \rel always participate in the
same compartment type. Hence, equations (1) to (5) of \textbf{[Ku-SLE15]} are satisfied.

Note here, that reasoning about role-based models does not include checking \emph{well-formed\-ness}
as defined in Definition 1 of \textbf{[Ku-SLE15]}, since that is a pure syntactical check. Therefore the
above definition already ensures that a \SCROM is well-formed. 

Next, we introduce instances based on role-based models.


\begin{definition}[Compartment Role Object Instance, Satisfiability]\label{def:scroi}
  Let $\Sigma = (\NT, \RT,$ \todo{Zeilenumbruch hier???}$\CT,\RST)$ be a vocabulary.  Then, a
  \emph{Compartment Role Object Instance \I over $\Sigma$ ($\Sigma$-CROI)} is a tuple
  $\I=(\Gamma^{\I},\type,\plays,\links)$, where
  \begin{itemize}
  \item $\Gamma^{\I}$ is a non-empty domain,
  \item $\type:\Gamma^{\I}\to\NT\cup\RT\cup\CT$ is a total function,
  \item $\plays \subseteq \Osf\times\Csf\times\Rsf$ is a ternary relation, and
  \item $\links: (\RST\times\Csf) \to \powerset{\Rsf\times\Rsf}$ is a total function.
  \end{itemize}
  with 
  \begin{align*}
    \Nsf & \coloneqq \{d \in \Gamma^{\I} \mid \type(d) \in \NT\}, \\
    \Rsf & \coloneqq \{d \in \Gamma^{\I} \mid \type(d) \in \RT\}, \\
    \Csf & \coloneqq \{d \in \Gamma^{\I} \mid \type(d) \in \CT\}\text{ and} \\
    \Osf & \coloneqq \Nsf \cup \Csf
  \end{align*}
  being the sets of \emph{naturals}, \emph{roles}, \emph{compartments} and
  \emph{objects}, respectively. Furthermore, the set of all objects playing a role in $c$ is denoted by
  $\Osf[\I,c]$, i.e.\ $\Osf[\I,c] \coloneqq \{o \in \Osf \mid (o,c,\cdot) \in \plays\}$. For
  $T \in \NT\cup\RT\cup\CT$, $T^{\I}$ is the set of all elements of that type, i.e.\
  $T^{\I} \coloneqq \{d \in \Gamma \mid \type(d) = T\}$.

  A $\Sigma$-CROI \I \emph{satisfies} a \SCROM{} \Mmc, denoted by $\I\models\Mmc$, if it has the following
  properties:
  \begin{enumerate}
  \item The \plays-relation respects \fills, i.e.~for each tuple $(o,c,r)\in\plays$ the type of $o$
    fills the type of $r$:
    \begin{align*}
      \{(o,r)\mid(o,\cdot,r)\in\plays\}\ \subseteq\ \{(o,r)\mid\text{there exists
        $(T,\rt)\in\fills$ s.t. $o\in T^{\I}$, $r\in \rt^{\I}$}\}.
    \end{align*}
  \item The \plays-relation respects \parts, i.e.~for each tuple $(o,c,r)\in\plays$ the type of $r$
    participates in the type of $c$:
    \begin{align*}
      & \{(c,r)\mid(\cdot,c,r)\in\plays\}\\
      & \qquad \subseteq\ \{(c,r)\mid \text{there exists $\ct \in \CT$, $\rt \in \RT$ s.t. $c \in
        \ct^{\I}$, $r \in \rt^{\I}$, $\rt \in \parts(\ct)$}\}.
    \end{align*}
  \item Each object can only play one role of each role type in each compartment:
    \begin{align*}
      \{(o,c,r),(o,c,r')\}\subseteq\plays \textImplies \type(r)\neq\type(r').
    \end{align*}
  \item Each role is played by exactly one object in exactly one compartment:
    \begin{align*}
      |\{(o,c)\mid(o,c,r)\in\plays\}| = 1 \quad\text{for all $r \in \Rsf$}.
    \end{align*}
  \item Roles occurring in the image of \links are played in the associated compartment, i.e.\ for
    each $(r_{1},r_{2})\in\links(\rst,c)$ there exists objects that play $r_{1}$ and $r_{2}$ in $c$:
    \begin{align*}
      \{r_{1} \mid (r_{1},\cdot) \in \links(\cdot,c)\} \cup \{r_{2} \mid (\cdot,r_{2}) \in \links(\cdot,c)\} \ \subseteq\ \{r\mid(\cdot,c,r)\in\plays\}.
    \end{align*}
  \item The \links-function respects \rel, i.e.\ for each $(r_{1}, r_{2}) \in \links(\rst, \cdot)$ the
    types of $r_{1}$ and $r_{2}$ are related via \rst:
    \begin{align*}
      (r_{1},r_{2}) \in \links(\rst, \cdot) \textImplies \rel(\rst)=(\type(r_{1}),\type(r_{2})).
    \end{align*}
  \end{enumerate}

  A \SCROM{} \Mmc is \emph{satisfiable} if there exists any \SCROI{} \I such that $\I\models\Mmc$. 
\end{definition}

We say that $r$ is an $\rt$-role or $c$ is a $\ct$-compartment if, respectively,
$\type(r) = \rt \in \RT$ or $\type(c) = \ct \in \CT$.  Furthermore, \emph{$o$ plays $r$ in $c$} and
$o$ is the \emph{player} of $r$ if $(o,c,r) \in \plays$, and \emph{$r_{1}$ is linked to $r_{2}$ via
  $\rst$ in $c$} if $(r_{1}, r_{2}) \in \links(\rst, c)$.

Since the \plays-relation respects the \fills- and the \parts-relation, if $o$ plays an \rt-role in
a \ct-compartment, then the type of $o$ must fill \rt and \rt must participate in \ct. If $o$ plays
$r_{1}$ and $r_{2}$ in $c$ then $r_{1}$ and $r_{2}$ must have different types, because each object
can only play one role of each type in the same compartment. Moreover, for each role there exists
exactly one object that plays it and one compartment where it is played in. In contrast to the
formalisation in \textbf{[Ku-SLE15]} we omit $\varepsilon$-roles, but roles that are linked via a
relationship type are both played in the same compartment and must be instances of the correct types
since \links respects \rel.  Thus, equations (6) to (11) of \textbf{[Ku-SLE15]} are satisfied.


Before we investigate how the information about a \SCROM can be encoded in a description logic
ontology, we have to discuss the main reasoning tasks for role-based models. The arguably most
apparent question is, given a \SCROM{} \Mmc and a \SCROI{} \I, whether \I is compliant with
\Mmc. But as this task rather belongs to the area of model checking, we will not focus in this
thesis on that problem.
%
Instead, given a \SCROM{} \Mmc, it is much more interesting whether there exists any \SCROI that is
compliant with \Mmc.  Additionally we often want to know for a specific \SCROM{} \Mmc whether there
exists a compliant \SCROI that fulfills certain assertions, e.g.\ that a role of a certain type is
played.  To express these assertional knowledge, we introduce a so-called \SCROA, a set of
assertions which should be fulfilled by an \SCROI.

\begin{definition}[$\Sigma$-Compartment Role Object Assertions] \label{def:scroa} Let
  $\Sigma = (\NT, \RT, \CT, \RST)$ be a vocabulary and let \IND be a non-empty set of individual
  names disjoint from $\Sigma$.  A \emph{Compartment Role Object Assertion over $\Sigma$} is of the
  form
  \begin{itemize}
  \item $T(a)$ with $T \in \NT \cup \CT \cup \RT$,
  \item $\playass(a_{1}, a_{2}, a_{3})$ with $a_{1}, a_{2}, a_{3} \in \IND$, or
  \item $\linkass(\rst, a_{1}, a_{2}, a_{3})$ with $\rst \in \RST$ and  $a_{1}, a_{2}, a_{3} \in \IND$ .
  \end{itemize}

  A \emph{set of Compartment Role Object Assertions \A over $\Sigma$ (\SCROA)} is a set of such
  assertions.
  %
  We extend the \SCROI{} \I to additionally map individual names to domain elements, e.g.\ $a$ is
  mapped to a domain element $a^{\I} \in \Gamma^{\I}$. A \SCROI{} \I \emph{satisfies an assertion
    $\alpha$}, denoted by $\I\models\alpha$ if
  \begin{itemize}
  \item for $\alpha$ of the form $T(a)$: $a^{\I} \in T^{\I}$,
  \item for $\alpha$ of the form $\playass(a_{1}, a_{2}, a_{3})$:
    $(a_{1}^{\I}, a_{2}^{\I}, a_{3}^{\I}) \in \plays$, and
  \item for $\alpha$ of the form $\linkass(\rst, a_{1}, a_{2}, a_{3})$:
    $(\rst, a_{1}^{\I}, a_{2}^{\I}, a_{3}^{\I}) \in \links$.
  \end{itemize}

  A \SCROI{} \I \emph{satisfies \A}, denoted by $\I\models\A$ if it satisfies all assertions
  in \A.
\end{definition}

Note here, that without any assertions or further restrictions as introduced in
Section~\ref{sec:constraint-level} there always exists a trivial CROI with the singleton set $\Gamma =
\{o\}$, the type of $o$ being some natural type, and \plays and \links being empty sets that satisfies \Mmc.


\subsection{Constraint Level}
\label{sec:constraint-level}

When modelling a domain of interest, not only the type of an object defines whether that object is
allowed to play a certain role. These additional constraints can be divided into four groups.

The first category of constraints are \emph{role constraints}, e.g. roles that mutually exclude each
other or playing one role implies playing another role. More general these constraints are
formalized with  so-called \emph{role groups}. These consist of a set of role
types (or again role groups) and a lower and an upper bound. An object fulfills a role group if it
plays at least the lower and at most the upper bound of roles from the set of role types.


 

\begin{definition}[Syntax of Role Groups]\label{def:syntax-role-groups}
  Let \RT be a set of role types. The set of \emph{role groups over \RT} is the smallest such that
  \begin{itemize}
  \item if $\rt \in \RT$, then \rt is an (\emph{atomic}) role group, and
  \item if $A_{1}$, \dots, $A_{n}$ are role groups, $k,l \in \nat$, then $(\{A_{1}, \dots, A_{n}\},
    k,l)$ is a (\emph{complex}) role group.
  \end{itemize}
  \emph{Atoms} of a role group $A$ are defined as:
  \begin{align*}
    \atom(A) & \coloneqq
               \begin{cases}
                 \{\rt\} & \text{if $A = \rt \in \RT$}\\
                 \bigcup_{i=1}^{n} \atom(A_{i}) & \text{if $A = (\{A_{1}, \dots, A_{n}\},k,l)$}.
               \end{cases}
  \end{align*}

  \vspace{-1.81\baselineskip}
\end{definition}

The semantics of a role group are based on a \SCROI and are locally evaluated for each domain
element and each compartment.  The interpretation function $\cdot^{\I,c,o}$ calculates recursively
whether an object fulfills the role group.

\begin{definition}[Semantics of Role Groups]\label{def:semantics-role-groups}
  Given a \SCROI{} \I, the semantics of a role group $A$ is defined for an object $o \in \Osf$ in
  $c \in \Csf$ as follows:
  \begin{align*}
    A^{\I,c,o} & \coloneqq 
                 \begin{cases}
                   1 & \text{if $A = \rt\in\RT$ and $o$ plays an \rt-role in $c$,} \\
                   1 & \text{if $A = (\{B_{1},\dots,B_{n}\},k,l)$ and $k \leq \sum_{i=1}^{k}
                     B_{i}^{\I,c,o} \leq l$, and}\\
                   0 & \text{otherwise.}
                 \end{cases}
  \end{align*}

  If $A^{\I,c,o} = 1$, we say that $o$ fulfills $A$ in $c$.
\end{definition}

\todo[inline]{role groups: role implication, equivalence, and so on can be expressed via role
  groups. very expressive role constraints can be expressed}


\todo[inline]{occurrence constraints}

\todo[inline]{cardinality constraints over relationship types}

\todo[inline]{intra-relationship type constraints.}




\begin{definition}[Constraint Set]
  Let $\Sigma = (\NT, \RT, \CT, \RST)$ be a vocabulary, let \RG be the set of role groups over \RT
  and let $\Card \coloneqq \nat \times \natinf$ be the set of cardinalities.  Then, a
  \emph{$\Sigma$-Compartment Role Object Constraint Set (\SCROC) \Cmc} is a tuple $\CC$ where
  \begin{itemize}
  \item $\occur : \CT \to \powerset{\Card \times \RG}$,
  \item $\card : \RST \to \Card \times \Card$, and
  \item $\intra : \RST \to \powerset{\Emc}$ with \Emc being a set of functions of the form
    $e : \powerset{S\times S}\to \{\true, \false\}$ for an arbitrary set $S$ \todo{how to represent
      ``symmetric'' or ``acyclic'' as function?}
  \end{itemize}
  are total functions. A \SCROI{} \I \emph{satisfies \Cmc}, denoted by $\I\models\Cmc$, if it has
  the following properties:
  \begin{enumerate}

  \item All occurrence constraints are respected, i.e.\ if $(k..l,A) \in \occur(\ct)$, then in every
    \ct-compartment there must exist at least $k$ and at most $l$ objects that fulfill role group
    $A$:\todo{im mapping überprüfen: comptype wo exakt 3 objekte rollenimplikation erfüllen}
    \begin{align*}
      ((k,l),A) \in \occur(\ct) \textImplies  \ct^{\I} \subseteq \left\{c \in \Csf \mmid k \leq \sum\nolimits_{o\in\Osf[\I,c]}
      A^{\I,c,o} \leq l \right\}
    \end{align*}

  \item All role groups must be satisfied, i.e.\ if an object $o$ plays an \rt-role and \rt is an
    atom of role group A, then $o$ must fulfill $A$:
    \begin{align*}
      (o,c,r) \in \plays \text{, } r \in \rt^{\I} \text{ and } \rt \in \atom(A) \textImplies
      A^{\I,c,o} = 1\text{, for all $o \in \Osf$, $A \in \RG$}
    \end{align*}

  \item All cardinality constraints are respected, i.e.\ every role that is played in a compartment
    $c$ and whose type is either the domain or the range of a relationship type \rst with
    $\card(\rst) = (i..j, k..l)$ must have at least $k$ and at most $l$ \rst-successors in $c$ or at
    least $i$ and at most $j$ \rst-predecessors in $c$, respectively:
    \begin{align*}
      & (\cdot,c,r) \in \plays \text{, } r \in \rt[1]^{\I} \text{, } \rel(\rst) = (\rt[1], \cdot) \text{ and
        } \card(\rst)=(\cdot,k..l)\\
      & \qquad \textImplies k \leq | \Succ(\rst,r,c) | \leq l \\[1ex]
      & (\cdot,c,r) \in \plays \text{, } r \in \rt[2]^{\I} \text{, } \rel(\rst) = (\cdot, \rt[2]) \text{ and
        } \card(\rst)=(i..j,\cdot)\\
      & \qquad \textImplies i \leq | \Pred(\rst,r,c) | \leq j
    \end{align*}

  \item All intra-relationship type constraints are respected, i.e.\ every function $\fsf \in
    \intra(\rst)$, evaluated over the players of the roles related via \rst, must return \true:
    \begin{align*}
      & \fsf \in \intra(\rst) \textImplies \fsf(\links^{*}(\rst,c)) = \true, \\
      & \qquad\text{for all $c$ in $\ct^{\I}$ s.t.\ \rst participates in \ct}.
    \end{align*}
  \end{enumerate}

  The auxiliary functions used above are defined as follows:
  \begin{align*}
    \Succ(\rst,r,c) & \coloneqq \{r' \in \Rsf \mid (r,r') \in \links(\rst,c)\}, \\
    \Pred(\rst,r,c) & \coloneqq \{r' \in \Rsf \mid (r',r) \in \links(\rst,c)\}\text{, and} \\
    \links^{*}(\rst,c) & \coloneqq \{ (o_{1}, o_{2}) \mid (r_{1}, r_{2}) \in \links(\rst,c) \text{
                         and } (o_{1}, c, r_{1}), (o_{2}, c, r_{2}) \in \plays\}.
                         \qedhere
  \end{align*}

\end{definition}

\todo[inline]{paragraph about fulfilling equations (13) to (16) in SLE15}


\begin{definition}[Constrained $\Sigma$-Compartment Role Object Model, Satisfiability Problem]
  \label{def:constrained-sigma-crom}
  Let $\Sigma = (\NT, \RT, \CT, \RST)$ be a vocabulary, let \Mmc be a \SCROM, let \Amc be a \SCROA
  and let \Cmc be a \SCROC.
  %
  Then, a \emph{Constrained $\Sigma$-Compartment Role Object Model \SCCROM} is the tuple
  $\Kmc = (\Mmc, \Amc, \Cmc)$.

  The \emph{satisfiability problem} for \SCCROM{s} is the problem of deciding for a given \SCCROM{}
  $\Kmc = (\Mmc, \Amc, \Cmc)$ whether there exists a \SCROI that satisfies \Mmc, \Amc and \Cmc.
\end{definition}


\section{Representing Role-Based Models}
\label{sec:representating-role-based-models}
\todo[inline, caption={open questions}]{Open question:
  \protect\begin{itemize}
  \protect\item Which DL is needed for \LM?
  \protect\item Wich DL is needed for \LO?
  \protect\end{itemize}
}

\todo[inline]{Objective: Given the \SCCROM \Kmc construct a \LMLO knowledge base $\Bmf_{\Kmc}$ such
  that $\Bmf_{\Kmc}$ is consistent iff \Kmc is satisfiable.}

\todo[inline]{research on how to formally represent objects of OOP}

\todo[inline]{translate UML to DLs}

\todo[inline]{object -> attributes as DL roles, context-independent and hence rigid roles}

\todo[inline]{for role-based models, we have context-dependant knowledge}

\todo[inline]{contexts in \LMLO as compartments.}

\todo[inline, caption={central design decisions}]{central design decision how to represent an object
  $o$ playing a role $r$ in a context $c$. Ternary relation that cannot be expressed in classical
  description logics. More precisely, role-playing can be expressed as binary relation using CDLs
  and context-local knowledge. Compartment types as meta concept names. Natural types and Role types
  as object concept names.}

\todo[inline]{Still two possibilities to represent that $o$ plays an \rt-role. }

\begin{figure}
  \centering
  \begin{tikzpicture}
    %\grid{(-6,-1.5)}{(6,1.5)}
    \node[node,label={Person, Student}] (a) at (-4,0) {};
    \node[node,label={Person}] (b) at (0,0) {};
    \node[node,label={Student}] (c) at (3,0) {};
    \draw[edge, bend right=10] (b) to[swap] node{\plays} (c);
    \draw[very thin] (-1.5,-1) -- (-1.5,1);
  \end{tikzpicture}
  \caption{Representing an object playing a \rosirole}
  \label{fig:two-ways-to-represent-roles}
\end{figure}

Generally, in a \SCROM compartments are also allowed to play roles in other compartments. Within
these other compartments a compartment playing a role does not behave differently than a
natural. Hence, we have compartment types both as meta concept names, i.e.\ as contexts in which
other objects play roles, and as object concept types, i.e.\ as objects that play roles in a
context. In a \SCROM there is a one-to-one relationship since the compartment as role-player and as
context is the same object. In our formalism we cannot establish that tight connection, but we can
assure the existence of contexts of a certain compartment type via a meta role \nested if objects of
that type play roles. Since we cannot restrict the number of existing contexts in a nested DL
interpretation, this is sufficient for the satisfiability problem. To distinguish between
compartment types as contexts and as objects, we call the former simply \emph{contexts} and the latter
\emph{o-compartments} and introduce a copy \CT* of all compartment types \CT.

To sum up, we consider the meta signature $\Msig=(\MC,\MR,\MI)$ and object signature
$\Osig=(\OC,\OR,\OI)$ such that
\begin{itemize}
\item $\CT \subseteq \MC$ since every compartment type as context is a meta concept,
\item $\nested \in \MR$ to assure the existence of compartments that play roles,
\item $\NT\cup\CT* \subseteq \OCR$ since every natural type and every compartment type as
  o-compart\-ment is an rigid object concept,
\item $\RT \subseteq \OCF$ since since every \rosirole type is a non-rigid object concept,
\item $\plays\in\ORF$ to express the \plays-relation, 
\item $\RST \subseteq \ORF$ since every relationship type is an flexible object role, and
\item $\occurCounter \in \OI$ \todo{}
\end{itemize}
Additionally, we introduce the rigid object concept $\Ant \in \OCR$ for all objects eligible of
playing \rosiroles, i.e.\ naturals and o-compartments, and the flexible object concepts
$\Art\in\OCF$ for all \rosiroles and $\Arg\in\OCF$ for all instances of \rosirole groups since we
will consider \rosirole groups of the constraint set similar to \rosiroles.

At first, we express general knowledge about $\Sigma$ that is independent of the specific
\SCROM.

\subsubsection*{Knowledge about the vocabulary  \ensureboldmath{\Sigma}}

Every context belongs to exactly one compartment type.
\begin{align}
  \top & \sqsubseteq \bigsqcup_{\ct\in\CT} \ct \label{eq:compartments-coverage}\\
  \ct[1] \sqcap \ct[2] & \sqsubseteq \bot 
      \text{\hspace{3em} for all $\ct[1], \ct[2] \in \CT$, $\ct[1]\neq\ct[2]$}
\end{align}

\noindent In every context, every natural or o-compartment and every \rosirole belongs to exactly one type.
\begin{align}
  \top & \sqsubseteq \oax{ \Ant \equiv \bigsqcup_{\nt\in\NT}\nt \sqcup \bigsqcup_{\ct*\in\CT*}\ct*}\\
  \top & \sqsubseteq \bigsqcap_{\substack{T_{1},\,T_{2}\in\NT\cup\CT*,\\ T_{1} \neq T_{2}}}
      \oax{T_{1} \sqcap T_{2} \sqsubseteq \bot}\\
  \top & \sqsubseteq \oax{ \Art \equiv \bigsqcup\limits_{\rt\in\RT}\rt} \label{eq:roles-coverage}\\
  \top & \sqsubseteq \bigsqcap_{\substack{\rt[1],\,\rt[2]\in\RT,\\ \rt[1]\neq\rt[2]}}
      \oax{\rt[1] \sqcap \rt[2] \sqsubseteq \bot} \label{eq:roles-disjoint}
\end{align}

\noindent On object level, every element is either a \rosirole, a natural or o-compartment, an
instance of a \rosirole group or the individual \occurCounter.
\begin{align}
  \top & \sqsubseteq \oax{\top \sqsubseteq \Ant \sqcup \Art \sqcup \Arg \sqcup \{\occurCounter\}}\\
  \begin{split}
  \top & \sqsubseteq \oax{\Ant \sqcap \Art \sqsubseteq \bot} 
      \sqcap \oax{\Ant \sqcap \Arg \sqsubseteq \bot}
      \sqcap \oax{\Art \sqcap \Arg \sqsubseteq \bot} \\
    & \qquad \sqcap \oax{\lnot(\Ant \sqcup \Art \sqcup \Arg)(\occurCounter)}
  \end{split}
\end{align}

\noindent Next, every natural or o-compartment can only play one \rt-\rosirole in each context and
each \rosirole must be played by some object.
\begin{align}
  \top & \sqsubseteq \bigsqcap_{\rt\in\RT} \oax{\Ant \sqsubseteq \atmost{1}{\plays}{\rt}} \\
  \top & \sqsubseteq \oax{\Art \sqsubseteq \atleast{1}{\plays^{-}}{\top} 
         \sqcap \atmost{1}{\plays^{-}}{\top}}
\end{align}

\noindent We formalize a general domain and range restriction for \plays. Only naturals or o-compart\-ments
can play something, and only \rosiroles or instances of \rosirole groups can be played.
\begin{align}
  \top & \sqsubseteq \oax{ \exists\plays.\top \sqsubseteq \Ant} \\
  \top & \sqsubseteq \oax{\top \sqsubseteq \forall\plays.(\Art\sqcup\Arg)}
\end{align}

\noindent Finally, if an o-compartment plays a \rosirole in some context, the o-compartment must also exist as
context.
\begin{align}
  \lnot\oax{\ct* \sqcap \exists\plays.\top\sqsubseteq\bot} & \sqsubseteq \exists\nested.\ct
      \text{\hspace{3em} for all $\ct* \in \CT*$}
\end{align}


\noindent With the general knowledge about the vocabulary $\Sigma$ being set up, we can look into
specific knowledge for a given \SCROM{} \MM.

\subsubsection*{Knowledge about the \SCROM{} \Mmc}

The \fills-relation restricts which natural or compartment types are allowed to play which \rosirole
types. Hence, all \plays-successors of naturals or o-compartments of a specific type are either
instances of a \rosirole type that are filled by that type or instances of a \rosirole
group. Analogously, a \rosirole type has as \plays-predecessors only naturals or o-compartments of
types which fill that \rosirole type.
\begin{align}
  \top & \sqsubseteq \bigsqcap_{T\in\NT\cup\CT*}\oax{T \sqsubseteq \forall\plays.
      \bigg(\Arg \sqcup \bigsqcup\nolimits_{(T,\rt)\in\fills} \rt \bigg)}\\
  \top & \sqsubseteq \bigsqcap_{\rt\in\RT}\oax{\exists\plays.\rt \sqsubseteq 
      \bigg( \bigsqcup\nolimits_{(T,\rt)\in\fills} T \bigg)}
\end{align}

\noindent Since in a valid \SCROI the \plays-relation respects \parts, only \rt-\rosiroles with
$\rt\in\parts(\ct)$ exist in a \ct-context.
\begin{align}
  \ct & \sqsubseteq \oax{\Art \sqsubseteq \bigsqcup_{\rt\in\parts(\ct)}\rt}
      \text{\hspace{3em} for all $\ct\in\CT$} \label{eq:roles-in-compartment}
\end{align}

\noindent Analogous to \fills restricting the domain and range of \plays, the \rel-function
restricts them for each relationship type.
\begin{align}
  \begin{split}
    \top & \sqsubseteq \oax{\exists\rst.\top\sqsubseteq\rt[1]} \sqcap
         \oax{\top\sqsubseteq\forall\rst.\rt[2]}\\
       & \hspace{5em}\text{for all $\rst\in\RST$ and $\rel(\rst) = (\rt[1],\rt[2])$}
  \end{split}
\end{align}

\noindent Note here, that due to equations~\eqref{eq:compartments-coverage},
\eqref{eq:roles-coverage},~\eqref{eq:roles-disjoint} and~\eqref{eq:roles-in-compartment} and the
fact that \parts' codomain is a partition of \RT, in any context that is not in \ct there are no
\rosiroles of a type the participates in \ct , e.g. the following axiom is entailed for all
$\ct\in\CT$:
\begin{align*}
  \lnot\ct & \sqsubseteq \oax{\bigsqcup_{\rt\in\parts(\ct)}\rt\sqsubseteq\bot}
\end{align*}

\noindent Next, let \A be a \SCROA. Compartment role object assertions can be formalized as meta
concept assertions.

\subsubsection*{Knowledge about the \SCROA{} \A}

For any assertion of the form $\ct(a)\in\A$ with $\ct\in\CT$ the individual $a$ must be a context of
type \ct.
\begin{gather}
  \ct(a)
\end{gather}

For $T(a)\in\A$ with $T\in\NT\cup\RT$ the individual $a$ is a natural or \rosirole
  that belongs to the concept $T$ in some context.
\begin{gather}
  \oax{T(a)}(x_{new})
\end{gather}

A \plays assertion $\playass(a_{1}, a_{2}, a_{3}) \in \A$ states that $a_{1}$ plays $a_{3}$
  in $a_{2}$.
\begin{gather}
  \oax{\plays(a_{1},a_{3})}(a_{2})
\end{gather}

A \links assertion $\linkass(\rst,a_{1},a_{2},a_{3}) \in \A$ states that $a_{2}$ is
  related to $a_{3}$ in $a_{1}$ via \rst.
\begin{gather}
  \oax{\rst(a_{2}, a_{3})}(a_{1})
\end{gather}

\todo[inline]{introduction sentences to constraint set \Cmc}

\subsubsection*{Knowledge about the \SCROC{} \Cmc}

Let \Cmc be a \SCROC and let $\RG(\Cmc) = \{\rg[1], \dots, \rg[n]\}$ be the set of all complex
\rosirole groups occurring in \Cmc. Analogous to \rosiroles, \rosirole groups are disjoint, every
instance of a \rosirole group must be played by some object and every object can either fulfill or not
fulfill a \rosirole group.
\begin{align}
  \top & \sqsubseteq \oax{ \Arg \equiv \bigsqcup_{\rg\in\RG(\Cmc)}\rg} 
      \sqcap \bigsqcap_{\substack{\rg[1],\,\rg[2]\in\RG(\Cmc),\\ \rg[1]\neq\rg[2]}} 
      \oax{\rg[1] \sqcap \rg[2] \sqsubseteq \bot}
      \label{eq:rolegroups-coverage-and-disjoint}\\
  \top & \sqsubseteq \oax{\Arg \sqsubseteq \atleast{1}{\plays^{-}}{\top} 
      \sqcap \atmost{1}{\plays^{-}}{\top}} \\
  \top & \sqsubseteq \bigsqcap_{\rg\in\RG(\Cmc)} \oax{\Ant \sqsubseteq \atmost{1}{\plays}{\rg}}
\end{align}

\noindent Complex \rosirole groups are treated like abstract \rosiroles. An object can ``play'' an
instance of a \rosirole group. This is equivalent to fulfilling that role group. So, the object must
``play'' the required number of containing \rosirole groups.
%
Furthermore, if an object plays a \rosirole whose type is an atom of a \rosirole group, the object
must also fulfill that \rosirole group.
\begin{align}
  \top & \sqsubseteq \bigsqcap_{\substack{\rg\in\RG(\Cmc),\\\rg = (\{A_{1}, \dots, A_{n}\},k,l)}}
      \oax{\exists\plays.\rg \equiv (\atleast{k}{\plays}{(A_{1} \sqcup \dots \sqcup A_{n})}) 
      \sqcap (\atmost{l}{\plays}{(A_{1} \sqcup \dots \sqcup A_{n})})}\\
  \top & \sqsubseteq \bigsqcap_{\rg\in\RG(\Cmc)}
      \oax{\exists\plays.\bigg(\bigsqcup\nolimits_{\rt\in\atom(\rg)}\rt\bigg)\sqsubseteq \exists\plays.\rg}
\end{align}

\noindent To capture the occurrence constraints we use an object individual name \occurCounter and
introduce an \counts-role from that individual to all \rosiroles and \rosirole group
instances. Thus, the occurrence constraints can be enforced with the help of qualified number
restrictions.
\begin{align}
  \top & \sqsubseteq \oax{\Art \sqcup \Arg \sqsubseteq \atleast{1}{\counts^{-}}{\{\occurCounter\}} 
      \sqcap \atmost{1}{\counts^{-}}{\{\occurCounter\}}}\\
  \begin{split}
    \ct & \sqsubseteq \oax{(\atleast{k}{\counts}{\rg})(\occurCounter)}
    \sqcap \oax{(\atmost{l}{\counts}{\rg})(\occurCounter)}\\
    & \text{\rlap{\hspace{5em} for all $(k..l,\rg)\in\occur(\ct)$, for all $\ct\in\CT$}}
  \end{split}
\end{align}

\noindent Cardinal constraints restrict the number of \rosiroles that are related to \rosirole via a
relationship type. \Rosiroles whose type is the domain or range of a relationship type \rst for
which there exists a cardinal constraint must have the correct amount of \rst successors or
predecessors, respectively.
\begin{align}
  \top & \sqsubseteq \bigsqcap_{\substack{\rst\in\RST, \\ \rel(\rst) = (\rt[1], \rt[2]), \\
  \card(\rst) = (i..j, k..l)}}
  \oax{\rt[1] \sqsubseteq \atleast{k}{\rst}{\top} \sqcap \atmost{l}{\rst}{\top}}
  \sqcap \oax{\rt[2] \sqsubseteq \atleast{i}{\rst^{-}}{\top} \sqcap \atmost{j}{\rst^{-}}{\top}} \label{eq:last-equation}
\end{align}

\todo[inline]{Some explanation about intra constraints, and that they cannot be expressed.}

\todo[inline, caption={restriction on mapping}]{restrictions on mapping
  
  What I cannot express:
  \protect\begin{itemize}
  \protect\item intra relationship constraints
  \protect\end{itemize}
}

\todo[inline]{\vspace{2cm}}

Given a \SCCROM{} \Kmc, we obtain the \ALCSHOIQ ontology
$\Bmf_{\Kmc} = (\Bmc_{\Kmc}, \emptyset, \emptyset)$ where $\Bmc_{\Kmc}$ is the conjunction of all
meta axioms from~\eqref{eq:compartments-coverage} to~\eqref{eq:last-equation}. In the next theorem
we establish the desired relationship between \Kmc and $\Bmf_{\Kmc}$.

\begin{theorem}
  Let \Kmc be a \SCCROM. Then, \Kmc is satisfiable iff $\Bmf_{\Kmc}$ is consistent.
\end{theorem}

\missingproof[5cm]





\clearpage

\section{Adding Inheritance}
\label{sec:adding-inheritance}
\todo[inline]{introduction paragraph}

\todo[inline]{natural type inheritance - what is important in this setting}




\section{Going beyond \texorpdfstring{$\Sigma$}{Sigma}-CROMs}
\label{sec:going-beyond-crom}

In the last sections we showed how contextualized description logics can represent \rosirole-based models

\todo[inline]{Example of constraints that are not part of CROM -> example American president must be
born in US}

\todo[inline]{temporal dimension}




%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../thesis"
%%% End:

%  LocalWords:  logics Kühn irreflexivity assertional satisfiability
